/*Select que traz a maior quantidade de
livros vendidos em uma compra*/
SELECT MAX(VL.BDQUANTIDADE)
FROM TVENDA_LIVROS VL

ou

SELECT FIRST 1 VL.BDCODVENDA, VL.BDCODLIVRO, VL.BDQUANTIDADE
FROM TVENDA_LIVROS VL
ORDER BY VL.BDQUANTIDADE DESC


/*Select que retorna o cliente
que mais comprou*/
SELECT FIRST 1 C.BDNOME,
               SUM(VL.BDQUANTIDADE)
FROM TVENDA_LIVROS VL
JOIN TCLIENTE C ON (VL.BDCODCLIENTE = C.BDCODCLIENTE)
GROUP BY C.BDNOME
ORDER BY SUM(VL.BDQUANTIDADE) DESC


/*Select retornando as compras reali-
zadas entre 01/01/2022 e 31/01/2022*/
SELECT VL.*
FROM TVENDA_LIVROS VL
WHERE VL.BDDATA BETWEEN '2022-01-01' AND '2022-01-31'


/*Select totalizando os 
valores das vendas*/
SELECT SUM(VL.BDVALOR)
FROM TVENDA_LIVROS VL


/*Select retornando a quantidade
de livros comprada por cliente*/
SELECT C.BDNOME,
       SUM(VL.BDQUANTIDADE)
FROM TVENDA_LIVROS VL
JOIN TCLIENTE C ON (VL.BDCODCLIENTE = C.BDCODCLIENTE)
GROUP BY C.BDNOME
ORDER BY SUM(VL.BDQUANTIDADE) DESC


/*Select retornando o gênero
de livro mais vendido*/
SELECT FIRST 1 G.BDDESCRICAO,
       SUM(VL.BDQUANTIDADE)
FROM TVENDA_LIVROS VL
JOIN TLIVROS L ON (VL.BDCODLIVRO = L.BDCODLIVRO)
JOIN TGENERO G ON (L.BDCODGENERO = G.BDCODGENERO)
GROUP BY G.BDDESCRICAO
ORDER BY SUM(VL.BDQUANTIDADE) DESC


/*Select retornando o autor com
o livro mais vendido*/
SELECT FIRST 1 L.BDAUTOR,
               SUM(VL.BDQUANTIDADE)
FROM TVENDA_LIVROS VL
JOIN TLIVROS L ON (VL.BDCODLIVRO = L.BDCODLIVRO)
GROUP BY L.BDAUTOR
ORDER BY SUM(VL.BDQUANTIDADE) DESC


/*Select retornando o total de
livros vendidos do gênero Fantasia*/
SELECT SUM(VL.BDQUANTIDADE)
FROM TVENDA_LIVROS VL
JOIN TLIVROS L ON (VL.BDCODLIVRO = L.BDCODLIVRO)
JOIN TGENERO G ON (L.BDCODGENERO = G.BDCODGENERO)
WHERE G.BDDESCRICAO = 'Fantasia'


/*Select retornando o valor total 
de vendas do gênero Fantasia*/
SELECT FIRST 1 SUM(VL.BDVALOR)
FROM TVENDA_LIVROS VL
JOIN TLIVROS L ON (VL.BDCODLIVRO = L.BDCODLIVRO)
JOIN TGENERO G ON (L.BDCODGENERO = G.BDCODGENERO)
ORDER BY SUM(VL.BDVALOR) DESC


/*Select totalizando os valores
das vendas por mês/ano*/
/*Utiliza-se: SUBSTRING(VL.BDDATA FROM 1 FOR 4) || '10'*/
SELECT SUBSTRING(VL.BDDATA FROM 6 FOR 2) || '/' || SUBSTRING(VL.BDDATA FROM 1 FOR 4) CONCAT,
       SUM(VL.BDVALOR)
FROM TVENDA_LIVROS VL
GROUP BY CONCAT
ORDER BY CONCAT